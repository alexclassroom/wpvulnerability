<?php
/**
 * API Class
 *
 * @package    WordPress
 * @author     David Perez <david@closemarketing.es>
 * @copyright  2022 Closemarketing
 * @version    1.0
 */

defined( 'ABSPATH' ) || exit;

/**
 * API Connector.
 *
 * API connector for Vulnerability.
 *
 * @since 1.0
 */
class API_WPVulnerability {

	/**
	 * Construct of Class
	 */
	public function __construct() {
	}

	public function get( $type, $version ) {

		$url = 'https://www.wpvulnerability.net/' . $type . '/' . $version . '/';
		$response = wp_remote_get( $url );
		if ( 200 === $response['response']['code'] ) {
			$body = wp_remote_retrieve_body( $response );
			error_log( '$body' . print_r( $body, true ) );
			return json_decode( $body, true );
		} else {
			return false;
		}

	}
}

$api_wpvulnerability = new API_WPVulnerability();
